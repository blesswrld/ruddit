generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql" // Указываем, что у нас PostgreSQL
  url          = env("DATABASE_URL") // Prisma возьмет URL из .env файла
  relationMode = "prisma"
}

// Описываем нашу первую модель - Пользователь
model User {
  id           String   @id @default(cuid()) // Уникальный ID
  username     String   @unique // Имя пользователя, должно быть уникальным
  email        String   @unique // Email, тоже уникальный
  passwordHash String   // Здесь будет храниться ЗАХЕШИРОВАННЫЙ пароль
  createdAt    DateTime @default(now()) // Дата создания
  updatedAt    DateTime @updatedAt // Дата обновления

  // Связь с созданными сообществами
  createdCommunities Community[] @relation("CreatedCommunities")

  posts Post[] 
}

model Community {
  id          String   @id @default(cuid())
  name        String   // Название сообщества
  slug        String   @unique // Слаг должен быть уникальным
  description String?  // Описание, необязательное
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Связь с создателем
  creatorId   String
  creator     User     @relation("CreatedCommunities", fields: [creatorId], references: [id])

  posts Post[]
}

model Post {
  id        String   @id @default(cuid())
  title     String
  content   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  authorId  String
  author    User     @relation(fields: [authorId], references: [id])

  communityId String
  community   Community @relation(fields: [communityId], references: [id])
}